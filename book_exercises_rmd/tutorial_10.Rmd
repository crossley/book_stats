---
title: "Tutorial 10"
author: "Author: Matthew J. Crossley"
date: "Last update: `r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: true
    toc_float:
        collapsed: false
        smooth_scroll: true
    toc_depth: 3
    fig_caption: yes
    # code_folding: show
    number_sections: false
    theme: cosmo
fontsize: 14pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, collapse=T)
```

```{r, echo=F}
library(data.table)
library(ggplot2)
library(ggpubr)
library(latex2exp)
```

## Work through these practice exercises

* It's a good idea to work through these on your own, but if
you get very stuck, solutions can be found
[here](tutorial_10_solutions.html)

### 1. 
Consider the following data:

```{r, echo=F}
a <- rnorm(5, 10, 2)
b <- rnorm(5, 12, 2)
c <- rnorm(5, 14, 2)
d <- rnorm(5, 10, 2)
d <- data.table(a, b, c, d)
d
```

* Assume that the observations in columns `a` are drawn from
a random variable $A \sim \mathcal{N}(\mu_A, \sigma_A)$.

* Assume that the observations in columns `b` are drawn from
a random variable $B \sim \mathcal{N}(\mu_B, \sigma_B)$.

* Assume that the observations in columns `c` are drawn from
a random variable $C \sim \mathcal{N}(\mu_C, \sigma_C)$.

* Assume that the observations in columns `d` are drawn from
a random variable $D \sim \mathcal{N}(\mu_D, \sigma_D)$.

* Using a one-way ANOVA, test the hypothesis that $\mu_A$,
$\mu_B$, $\mu_C$, and $\mu_D$ are different. Please populate
the following variables:

```{r, eval=F}
ans_1_obs # observed test statistic
ans_1_pval # p-value of test 
ans_1_crit # critical value of test
```

### 2.
Consider the following sampling distribution of an
$F_{obs}$ test statistic (indicated by the dashed line in
the plot), with $df_{between} = 10$ and $df_{within} = 100$.

```{r, echo=F}
set.seed(1)
x <- seq(0, 4, 0.01)
fx <- df(x, 10, 100)
f_obs <- rf(1, 10, 100)
d <- data.table(x, fx)
ggplot(d, aes(x, fx)) +
  geom_line() +
  geom_vline(xintercept = f_obs, linetype=2) +
  scale_x_continuous(breaks=c(0, f_obs, 1, 2, 3, 4)) +
  xlab('F') +
  ylab('Probability Density') +
  annotate('text', x=f_obs, y=0, label='F observed')
```

* Are the mean sqaured deviations greater within groups or
are they greater between groups? Please respond with one of
the following:

  * `ans_2a <- "within"` 
  * `ans_2a <- "between"` 
  
* What is the p-value of this test? Please store your answer
in a variable named `ans_2b`.

* What is the critical value of this test? Please store your
answer in a variable named `ans_2c`.


### 3.
Consider the motor learning experiment data located here:

https://crossley.github.io/cogs2020/data/mis/mis_data.csv

* This data is from a motor learning and motor control
experiment.

* On each trial, participants simply rested their hand in
the middle of a desk, and then tried to move their hand
quickly and accurately to a visual target somewhere on a
circle centred at their hand position and with a radius of
about 8 cm.

* We tested two different groups of people. One group were
college students, and the other group were professional
surgeons.

* The columns of this data file correspond to the following:

  * `subject`: Anonymous subject ID
  * `group`: Indicates college student or surgeon
  * `phase`: Indicates the phase of the experiment
  * `trial`: Trial number
  * `target`: The visual target was reached to for this trial
  * `error`: The mismatch between the centre of the target and the final hand position
  * `movement_time`: How long the movement lasted
  * `reaction_time`: How long until the movement began
  * `peak_velocity`: The maximum velocity reached during the reach

* Please note that this is a between subjects design with
respect to `condition`. This means that different subjects
are in each level of `condition`. This is true despite the
`subject` numbers being identical. They are only identical
because of an error in how the data were processed.

* Is the mean `error` per `subject` different across
different levels of `condition`? Answer this question by
performing a one-way ANOVA. Please populate the following
variables:

```{r, eval=F}
ans_3_obs # observed test statistic
ans_3_pval # pvalue of test 
ans_3_crit # critical value of test statistic
```

### 4.
Repeat problem 3 but this time use an appropriate
t-test (assuming there is equal variance in different
conditions).

```{r, eval=F}
ans_4_obs # observed test statistic
ans_4_pval # pvalue of test 
ans_4_crit_lower # lower critical value of test statistic
ans_4_crit_upper # upper critical value of test statistic
```
