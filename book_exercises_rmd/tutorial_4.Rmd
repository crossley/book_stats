---
title: "Tutorial 4"
author: "Author: Matthew J. Cossley"
date: "Last update: `r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: true
    toc_float:
        collapsed: false
        smooth_scroll: true
    toc_depth: 3
    fig_caption: yes
    # code_folding: show
    number_sections: false
    theme: cosmo
fontsize: 14pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, collapse=T)
```

```{r, echo=F}
library(data.table)
library(ggplot2)
library(ggpubr)
library(latex2exp)
```

## Work through these practice exercises
* It's a good idea to work through these on your own, but if
you get very stuck, solutions can be found
[here](tutorial_4_solutions.html)

### 1.
Consider an experiment in which two four-sided die are
thrown.

**(a)** Create a `data.table` named `ans_1a` with two
columns labelled `die1` and `die2` where these columns
encode the **sample space** of this experiment. As a hint,
the following shows the what the output of `ans_1a[1:8]`
should produce for you. It's up to you to determine how many
observations in total `ans_1a` should have.

```{r echo=FALSE}
die1 <- rep(c(1, 2, 3, 4), 4)
die2 <- rep(c(1, 2, 3, 4), each=4)
ans_1a <- data.table(die1, die2)
ans_1a[1:8]
```

**(b)** Create a deep copy of `ans_1a` called `ans_1b` and
then add a column to `ans_1b` called `X` and set it equal to
the sum of the corresponding `die1` and `die2` values on a
per row basis.

**(c)** Let $X$ be the random variable defined by the `X`
column in `ans_1b`. What is $P(X<5)$? Store your result in a
variable named `ans_1c`.

**(d)** Is the event defined as the set of all outcomes for
which $X=2$ an elementary event? Store your answer (`"YES"`
or `"NO"`) in a variable named `ans_1d`.


### 2.
For the following probability distribution:

<div width:50px>
| $x$    |  2 |  3 |  4 |  5 |  6 |
|:-------|:---|:---|:---|:---|:---|
| $f(x)$ | .1 | .3 | .3 | .2 | .1 |
</div>

**(a)** Is $f(x)$ a valid probability distribution? Store
your answer (`"YES"` or `"NO"`) in a variable named
`ans_2a`.

**(b)** Calculate $E(X)$ store the result in a variable
named `ans_2b`.

**(c)** Calculate $P(X \geq 4)$ store the result in a
variable named `ans_2c`.

**(d)** Calculate $P(2 < X \leq 4)$ and store the result in
a variable named `ans_2d`.


### 3.
Given the following probability distribution:

```{r, echo=FALSE}
x <- c(0, 1, 2, 3)
fx <- c(0.3, 0.4, 0.2, 0.1)
d <- data.table(x, fx)
ggplot(d, aes(x, fx)) +
  geom_point() +
  geom_segment(aes(x=x, y=0, xend=x, yend=fx)) +
  xlab("x") +
  ylab("P(X=x)")
```

Find:

**(a)** Calculate $P(X \geq 2)$ and store your result in a
variable named `ans_3a`.

**(b)** Calculate $P(0 < X \leq 2)$ and store your result in
a variable named `ans_3b`.

**(c)** Calculate $E(X)$ and store your result in a variable
named `ans_3c`.

**(d)** $Var(X)$ and store your result in a variable named
`ans_3d`.

**(e)** $sd(X)$ and store your result in a variable named
`ans_3e`.

### 4.
Consider the probability distributions for random vairbale
$X$ and random variable $Y$ defined below.
```{r, echo=F, fig.width=10}
x <- seq(-4, 4, 0.01)
fx <- dnorm(x)
d <- data.table(x, fx)
ga <- ggplot(d, aes(x, fx)) +
  geom_line() +
  ylab('f(x)')

n <- 2
p <- 0.2
y <- seq(0, n, 1)
fy <- dbinom(y, n, p)
d <- data.table(y, fy)
gb <- ggplot(d, aes(y, fy)) +
  geom_segment(data=d, aes(x=y, xend=y, y=0, yend=dbinom(y,n,p))) +
  scale_x_continuous(breaks=-5:5) +
  scale_y_continuous(breaks=fy) +
  ylab('f(y)')

ggarrange(ga, gb, ncol=2)
```

**a.** What is the population mean of $X$? Store your answer
in a variable named `ans_4a`.

**b.** What is the population mean of $Y$? Sore your answer
in a variable named `ans_4b`.

```{r, echo=F, fig.width=10}
x1 <- rnorm(100)
x2 <- rnorm(100, 10)
y1 <- rbinom(100, n, 0.2)
y2 <- rbinom(100, n, 0.5)
d <- data.table(x1, x2, y1, y2)
d <- melt(d)

ggplot(data=d, aes(value)) +
  geom_histogram(binwidth=0.1) +
  facet_wrap(~variable, scales='free') +
  theme(
    strip.background = element_blank(),
    strip.text.x = element_blank()
  )
```

**c.** Which of the histograms above most likely corresponds
to a sample from $X$? Please store your answer as one of the
following:

* `ans_4c <- 'upper left'`
* `ans_4c <- 'lower left'`
* `ans_4c <- 'upper right'`
* `ans_4c <- 'lower right'`

**d.** Which of the histograms above most likely corresponds
to a sample from $Y$? Please store your answer as one of the
following:

* `ans_4d <- 'upper left'`
* `ans_4d <- 'lower left'`
* `ans_4d <- 'upper right'`
* `ans_4d <- 'lower right'`

### 5.
**a.** Use the `fread` function in the `data.table` library
to read
`https://crossley.github.io/cogs2020/data/criterion_learning/crit_learn.csv`
into a `data.table` and store the result in a variable named
`ans_5a`.

**b.** Create a new `data.table` that contains only rows of
`ans_5a` for which `cnd` is `%in%` `c('Delay', 'Long ITI',
'Short ITI')`, and only the mean of the `t2c` column grouped
by `sub` and `cnd`. Store your result in a variable named
`ans_5b`.

**c.** Is `ans_5b` in wide or long format? Please use one of
the following lines to store your result in a variable named
`ans_4c`:

* `ans_5c <- 'wide'`
* `ans_5c <- 'long'`

**Note on 5d and 5e below:**
```{r, echo=T, include=F}
ans_5a<-fread('https://crossley.github.io/cogs2020/data/criterion_learning/crit_learn.csv')
ans_5b <- ans_5a[cnd %in% c('Delay', 'Long ITI', 'Short ITI'), .(t2c_mean = mean(t2c)), .(sub, cnd)]
```

**d.** Please recreate the following figure using `ans_5b`
as the source of data being plotted. Store the result of
your call to the `ggplot()` function in a variable named
`ans_5d`.

```{r, echo=F, include=T}
d <- fread('https://crossley.github.io/cogs2020/data/criterion_learning/crit_learn.csv')
d <- d[cnd %in% c('Delay', 'Long ITI', 'Short ITI'), .(t2c_mean=mean(t2c)), .(sub, cnd)]
ggplot(data=d, aes(x=cnd, y=t2c_mean)) +
  geom_violin() +
  geom_point()
```
