<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>27 Two-way ANOVA | Data analysis and statistics for cognitive neuroscience</title>
  <meta name="description" content="27 Two-way ANOVA | Data analysis and statistics for cognitive neuroscience" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="27 Two-way ANOVA | Data analysis and statistics for cognitive neuroscience" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="27 Two-way ANOVA | Data analysis and statistics for cognitive neuroscience" />
  
  
  

<meta name="author" content="Matthew J. Crossley" />


<meta name="date" content="2024-02-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="one-way-anova.html"/>
<link rel="next" href="repeated-measures-anova.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the book</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basics"><i class="fa fa-check"></i><b>2.1</b> Basics</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types"><i class="fa fa-check"></i><b>2.3</b> Data types</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#numeric"><i class="fa fa-check"></i><b>2.3.1</b> <code>numeric</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#character"><i class="fa fa-check"></i><b>2.3.2</b> <code>character</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#logical"><i class="fa fa-check"></i><b>2.3.3</b> <code>logical</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factor"><i class="fa fa-check"></i><b>2.3.4</b> <code>factor</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#containers"><i class="fa fa-check"></i><b>2.4</b> Containers</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vector"><i class="fa fa-check"></i><b>2.4.1</b> <code>vector</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#list"><i class="fa fa-check"></i><b>2.4.2</b> <code>list</code></a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data.frame"><i class="fa fa-check"></i><b>2.4.3</b> <code>data.frame</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#loops"><i class="fa fa-check"></i><b>2.5</b> Loops</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#for-loops"><i class="fa fa-check"></i><b>2.5.1</b> <code>for</code> loops</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#while-loops"><i class="fa fa-check"></i><b>2.5.2</b> <code>while</code> loops</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#conditional-flow"><i class="fa fa-check"></i><b>2.6</b> Conditional flow</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#custom-functions"><i class="fa fa-check"></i><b>2.7</b> Custom functions</a></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#inspect-existing-objects"><i class="fa fa-check"></i><b>2.8</b> Inspect existing objects</a></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#summary"><i class="fa fa-check"></i><b>2.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-data.html"><a href="introduction-to-data.html"><i class="fa fa-check"></i><b>3</b> Introduction to <code>data.table</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-data.html"><a href="introduction-to-data.html#loading-the-data.table-library-and-creating-a-data.table"><i class="fa fa-check"></i><b>3.1</b> Loading the <code>data.table</code> library and creating a <code>data.table</code></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-data.html"><a href="introduction-to-data.html#subset-rows-in-i"><i class="fa fa-check"></i><b>3.1.1</b> Subset rows in <code>i</code></a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-data.html"><a href="introduction-to-data.html#select-columns-with-j"><i class="fa fa-check"></i><b>3.1.2</b> Select columns with <code>j</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="introduction-to-data.html"><a href="introduction-to-data.html#select-and-operate-on-columns-with-j"><i class="fa fa-check"></i><b>3.1.3</b> Select and operate on columns with <code>j</code></a></li>
<li class="chapter" data-level="3.1.4" data-path="introduction-to-data.html"><a href="introduction-to-data.html#combine-i-and-j"><i class="fa fa-check"></i><b>3.1.4</b> Combine <code>i</code> and <code>j</code></a></li>
<li class="chapter" data-level="3.1.5" data-path="introduction-to-data.html"><a href="introduction-to-data.html#group-using-by"><i class="fa fa-check"></i><b>3.1.5</b> Group using <code>by</code></a></li>
<li class="chapter" data-level="3.1.6" data-path="introduction-to-data.html"><a href="introduction-to-data.html#adding-and-modifying-columns"><i class="fa fa-check"></i><b>3.1.6</b> Adding and modifying columns</a></li>
<li class="chapter" data-level="3.1.7" data-path="introduction-to-data.html"><a href="introduction-to-data.html#be-careful-when-copying-data.table-objects"><i class="fa fa-check"></i><b>3.1.7</b> Be careful when copying <code>data.table</code> objects</a></li>
<li class="chapter" data-level="3.1.8" data-path="introduction-to-data.html"><a href="introduction-to-data.html#getting-data-into-a-data.table"><i class="fa fa-check"></i><b>3.1.8</b> Getting data into a <code>data.table</code></a></li>
<li class="chapter" data-level="3.1.9" data-path="introduction-to-data.html"><a href="introduction-to-data.html#wide-vs-long-format"><i class="fa fa-check"></i><b>3.1.9</b> Wide vs long format</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-ggplot.html"><a href="introduction-to-ggplot.html"><i class="fa fa-check"></i><b>4</b> Introduction to <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-ggplot.html"><a href="introduction-to-ggplot.html#data-visualisation-using-ggplot"><i class="fa fa-check"></i><b>4.1</b> Data visualisation using <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-ggplot.html"><a href="introduction-to-ggplot.html#geom_histogram"><i class="fa fa-check"></i><b>4.1.1</b> <code>geom_histogram</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-to-ggplot.html"><a href="introduction-to-ggplot.html#geom_point"><i class="fa fa-check"></i><b>4.1.2</b> <code>geom_point</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-to-ggplot.html"><a href="introduction-to-ggplot.html#geom_boxplot"><i class="fa fa-check"></i><b>4.1.3</b> <code>geom_boxplot</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="introduction-to-ggplot.html"><a href="introduction-to-ggplot.html#geom_violin"><i class="fa fa-check"></i><b>4.1.4</b> <code>geom_violin</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="introduction-to-ggplot.html"><a href="introduction-to-ggplot.html#geom_hist"><i class="fa fa-check"></i><b>4.1.5</b> <code>geom_hist</code></a></li>
<li class="chapter" data-level="4.1.6" data-path="introduction-to-ggplot.html"><a href="introduction-to-ggplot.html#geom_bar"><i class="fa fa-check"></i><b>4.1.6</b> <code>geom_bar</code></a></li>
<li class="chapter" data-level="4.1.7" data-path="introduction-to-ggplot.html"><a href="introduction-to-ggplot.html#geom_line"><i class="fa fa-check"></i><b>4.1.7</b> <code>geom_line</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="what-is-statistics.html"><a href="what-is-statistics.html"><i class="fa fa-check"></i><b>5</b> What is statistics?</a>
<ul>
<li class="chapter" data-level="5.1" data-path="what-is-statistics.html"><a href="what-is-statistics.html#casual-definition"><i class="fa fa-check"></i><b>5.1</b> Casual definition</a></li>
<li class="chapter" data-level="5.2" data-path="what-is-statistics.html"><a href="what-is-statistics.html#why-are-statistics-necessary"><i class="fa fa-check"></i><b>5.2</b> Why are statistics necessary?</a></li>
<li class="chapter" data-level="5.3" data-path="what-is-statistics.html"><a href="what-is-statistics.html#more-formal-definition"><i class="fa fa-check"></i><b>5.3</b> More formal definition</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="what-is-statistics.html"><a href="what-is-statistics.html#core-concept"><i class="fa fa-check"></i><b>5.3.1</b> Core concept</a></li>
<li class="chapter" data-level="5.3.2" data-path="what-is-statistics.html"><a href="what-is-statistics.html#example"><i class="fa fa-check"></i><b>5.3.2</b> Example</a></li>
<li class="chapter" data-level="5.3.3" data-path="what-is-statistics.html"><a href="what-is-statistics.html#more-general-example"><i class="fa fa-check"></i><b>5.3.3</b> More general example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="experiment-design.html"><a href="experiment-design.html"><i class="fa fa-check"></i><b>6</b> Experiment Design</a>
<ul>
<li class="chapter" data-level="6.1" data-path="experiment-design.html"><a href="experiment-design.html#what-is-experiment-design"><i class="fa fa-check"></i><b>6.1</b> What is experiment design?</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="experiment-design.html"><a href="experiment-design.html#between-subjects-vs-within-subjects"><i class="fa fa-check"></i><b>6.1.1</b> Between-subjects vs within-subjects</a></li>
<li class="chapter" data-level="6.1.2" data-path="experiment-design.html"><a href="experiment-design.html#repeated-measures"><i class="fa fa-check"></i><b>6.1.2</b> Repeated measures</a></li>
<li class="chapter" data-level="6.1.3" data-path="experiment-design.html"><a href="experiment-design.html#mixed-designs"><i class="fa fa-check"></i><b>6.1.3</b> Mixed Designs</a></li>
<li class="chapter" data-level="6.1.4" data-path="experiment-design.html"><a href="experiment-design.html#why-choose-between--or-within-subjects"><i class="fa fa-check"></i><b>6.1.4</b> Why choose between- or within-subjects?</a></li>
<li class="chapter" data-level="6.1.5" data-path="experiment-design.html"><a href="experiment-design.html#continuous-vs-discrete-data"><i class="fa fa-check"></i><b>6.1.5</b> Continuous vs discrete data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-descriptive-statistics.html"><a href="basic-descriptive-statistics.html"><i class="fa fa-check"></i><b>7</b> Basic descriptive statistics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="basic-descriptive-statistics.html"><a href="basic-descriptive-statistics.html#learning-objectives"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="basic-descriptive-statistics.html"><a href="basic-descriptive-statistics.html#central-tendency-of-a-sample"><i class="fa fa-check"></i><b>7.2</b> Central tendency of a sample</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="basic-descriptive-statistics.html"><a href="basic-descriptive-statistics.html#central-tendency-by-hand"><i class="fa fa-check"></i><b>7.2.1</b> Central tendency by hand</a></li>
<li class="chapter" data-level="7.2.2" data-path="basic-descriptive-statistics.html"><a href="basic-descriptive-statistics.html#central-tendency-using-r"><i class="fa fa-check"></i><b>7.2.2</b> Central tendency using R</a></li>
<li class="chapter" data-level="7.2.3" data-path="basic-descriptive-statistics.html"><a href="basic-descriptive-statistics.html#central-tendency-and-outliers"><i class="fa fa-check"></i><b>7.2.3</b> Central tendency and outliers</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="basic-descriptive-statistics.html"><a href="basic-descriptive-statistics.html#spread-of-a-sample"><i class="fa fa-check"></i><b>7.3</b> Spread of a sample</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="basic-descriptive-statistics.html"><a href="basic-descriptive-statistics.html#spread-by-hand"><i class="fa fa-check"></i><b>7.3.1</b> Spread by hand</a></li>
<li class="chapter" data-level="7.3.2" data-path="basic-descriptive-statistics.html"><a href="basic-descriptive-statistics.html#spread-by-r"><i class="fa fa-check"></i><b>7.3.2</b> Spread by <code>R</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html"><i class="fa fa-check"></i><b>8</b> Probability and random variables</a>
<ul>
<li class="chapter" data-level="8.1" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#learning-objectives-1"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#probability-definitions"><i class="fa fa-check"></i><b>8.2</b> Probability definitions</a></li>
<li class="chapter" data-level="8.3" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#rules-of-probability"><i class="fa fa-check"></i><b>8.3</b> Rules of probability</a></li>
<li class="chapter" data-level="8.4" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#random-variables-and-distributions"><i class="fa fa-check"></i><b>8.4</b> Random variables and distributions</a></li>
<li class="chapter" data-level="8.5" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#sample-statistics-estimate-population-parameters"><i class="fa fa-check"></i><b>8.5</b> Sample statistics estimate population parameters</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#population-mean-for-discrete-x"><i class="fa fa-check"></i><b>8.5.1</b> Population mean for discrete <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="8.5.2" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#population-variance-for-discrete-x"><i class="fa fa-check"></i><b>8.5.2</b> Population variance for discrete <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="8.5.3" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#discrete-x-example"><i class="fa fa-check"></i><b>8.5.3</b> Discrete <span class="math inline">\(X\)</span> example</a></li>
<li class="chapter" data-level="8.5.4" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#population-mean-and-variance-for-continuous-x"><i class="fa fa-check"></i><b>8.5.4</b> Population mean and variance for continuous <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="8.5.5" data-path="probability-and-random-variables.html"><a href="probability-and-random-variables.html#continuous-x-example"><i class="fa fa-check"></i><b>8.5.5</b> Continuous <span class="math inline">\(X\)</span> example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="computing-probabilities-from-probability-distributions.html"><a href="computing-probabilities-from-probability-distributions.html"><i class="fa fa-check"></i><b>9</b> Computing probabilities from probability distributions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="computing-probabilities-from-probability-distributions.html"><a href="computing-probabilities-from-probability-distributions.html#learning-objectives-2"><i class="fa fa-check"></i><b>9.1</b> Learning objectives</a></li>
<li class="chapter" data-level="9.2" data-path="computing-probabilities-from-probability-distributions.html"><a href="computing-probabilities-from-probability-distributions.html#computing-probabilities"><i class="fa fa-check"></i><b>9.2</b> Computing Probabilities</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-r-to-compute-probabilities.html"><a href="using-r-to-compute-probabilities.html"><i class="fa fa-check"></i><b>10</b> Using R to compute probabilities</a></li>
<li class="chapter" data-level="11" data-path="expected-value.html"><a href="expected-value.html"><i class="fa fa-check"></i><b>11</b> Expected value</a>
<ul>
<li class="chapter" data-level="11.1" data-path="expected-value.html"><a href="expected-value.html#learning-objectives-3"><i class="fa fa-check"></i><b>11.1</b> Learning objectives</a></li>
<li class="chapter" data-level="11.2" data-path="expected-value.html"><a href="expected-value.html#central-tendency"><i class="fa fa-check"></i><b>11.2</b> Central tendency</a></li>
<li class="chapter" data-level="11.3" data-path="expected-value.html"><a href="expected-value.html#population-spread"><i class="fa fa-check"></i><b>11.3</b> Population spread</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bernoulli-random-variables.html"><a href="bernoulli-random-variables.html"><i class="fa fa-check"></i><b>12</b> Bernoulli random variables</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bernoulli-random-variables.html"><a href="bernoulli-random-variables.html#learning-objectives-4"><i class="fa fa-check"></i><b>12.1</b> Learning objectives</a></li>
<li class="chapter" data-level="12.2" data-path="bernoulli-random-variables.html"><a href="bernoulli-random-variables.html#bernoulli-random-variable"><i class="fa fa-check"></i><b>12.2</b> Bernoulli random variable</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="bernoulli-random-variables.html"><a href="bernoulli-random-variables.html#definition"><i class="fa fa-check"></i><b>12.2.1</b> Definition</a></li>
<li class="chapter" data-level="12.2.2" data-path="bernoulli-random-variables.html"><a href="bernoulli-random-variables.html#probability-distribution"><i class="fa fa-check"></i><b>12.2.2</b> Probability distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="binomial-random-variables.html"><a href="binomial-random-variables.html"><i class="fa fa-check"></i><b>13</b> Binomial random variables</a>
<ul>
<li class="chapter" data-level="13.1" data-path="binomial-random-variables.html"><a href="binomial-random-variables.html#learning-objectives-5"><i class="fa fa-check"></i><b>13.1</b> Learning objectives</a></li>
<li class="chapter" data-level="13.2" data-path="binomial-random-variables.html"><a href="binomial-random-variables.html#binomial-random-variable"><i class="fa fa-check"></i><b>13.2</b> Binomial random variable</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="binomial-random-variables.html"><a href="binomial-random-variables.html#definition-1"><i class="fa fa-check"></i><b>13.2.1</b> Definition</a></li>
<li class="chapter" data-level="13.2.2" data-path="binomial-random-variables.html"><a href="binomial-random-variables.html#probability-distribution-1"><i class="fa fa-check"></i><b>13.2.2</b> Probability distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="noraml-distribution.html"><a href="noraml-distribution.html"><i class="fa fa-check"></i><b>14</b> Noraml Distribution</a>
<ul>
<li class="chapter" data-level="14.1" data-path="noraml-distribution.html"><a href="noraml-distribution.html#learning-objectives-6"><i class="fa fa-check"></i><b>14.1</b> Learning objectives</a></li>
<li class="chapter" data-level="14.2" data-path="noraml-distribution.html"><a href="noraml-distribution.html#normal-distribution"><i class="fa fa-check"></i><b>14.2</b> Normal distribution</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="noraml-distribution.html"><a href="noraml-distribution.html#definition-2"><i class="fa fa-check"></i><b>14.2.1</b> Definition</a></li>
<li class="chapter" data-level="14.2.2" data-path="noraml-distribution.html"><a href="noraml-distribution.html#probability-distribution-2"><i class="fa fa-check"></i><b>14.2.2</b> Probability distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="distribution-of-sample-means.html"><a href="distribution-of-sample-means.html"><i class="fa fa-check"></i><b>15</b> Distribution of sample means</a>
<ul>
<li class="chapter" data-level="15.1" data-path="distribution-of-sample-means.html"><a href="distribution-of-sample-means.html#learning-objectives-7"><i class="fa fa-check"></i><b>15.1</b> Learning objectives</a></li>
<li class="chapter" data-level="15.2" data-path="distribution-of-sample-means.html"><a href="distribution-of-sample-means.html#introduction"><i class="fa fa-check"></i><b>15.2</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html"><i class="fa fa-check"></i><b>16</b> Central limit theorem</a>
<ul>
<li class="chapter" data-level="16.1" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#learning-objectives-8"><i class="fa fa-check"></i><b>16.1</b> Learning objectives</a></li>
<li class="chapter" data-level="16.2" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#central-limit-theorem-1"><i class="fa fa-check"></i><b>16.2</b> Central limit theorem</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#central-limit-theorem-mean-and-variance"><i class="fa fa-check"></i><b>16.2.1</b> Central limit theorem mean and variance</a></li>
<li class="chapter" data-level="16.2.2" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#applied-to-the-distribution-of-sample-sums"><i class="fa fa-check"></i><b>16.2.2</b> Applied to the distribution of sample sums</a></li>
<li class="chapter" data-level="16.2.3" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#applied-to-the-distribution-of-sample-means"><i class="fa fa-check"></i><b>16.2.3</b> Applied to the distribution of sample means</a></li>
<li class="chapter" data-level="16.2.4" data-path="central-limit-theorem.html"><a href="central-limit-theorem.html#standard-error"><i class="fa fa-check"></i><b>16.2.4</b> Standard Error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>17</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="17.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#learning-objectives-9"><i class="fa fa-check"></i><b>17.1</b> Learning objectives</a></li>
<li class="chapter" data-level="17.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#null-hypothesis-significance-testing"><i class="fa fa-check"></i><b>17.2</b> Null Hypothesis Significance Testing</a></li>
<li class="chapter" data-level="17.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#two-tailed-tests-introduction"><i class="fa fa-check"></i><b>17.3</b> Two-tailed tests introduction</a></li>
<li class="chapter" data-level="17.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#summary-1"><i class="fa fa-check"></i><b>17.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="inferential-error-and-statistical-power.html"><a href="inferential-error-and-statistical-power.html"><i class="fa fa-check"></i><b>18</b> Inferential error and statistical power</a>
<ul>
<li class="chapter" data-level="18.1" data-path="inferential-error-and-statistical-power.html"><a href="inferential-error-and-statistical-power.html#type-i-versus-type-ii-errors"><i class="fa fa-check"></i><b>18.1</b> Type I versus Type II errors</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="inferential-error-and-statistical-power.html"><a href="inferential-error-and-statistical-power.html#definitions"><i class="fa fa-check"></i><b>18.1.1</b> Definitions</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="inferential-error-and-statistical-power.html"><a href="inferential-error-and-statistical-power.html#power"><i class="fa fa-check"></i><b>18.2</b> power</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="inferential-error-and-statistical-power.html"><a href="inferential-error-and-statistical-power.html#increase-the-distance-between-h_0-and-h_1"><i class="fa fa-check"></i><b>18.2.1</b> Increase the distance between <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span></a></li>
<li class="chapter" data-level="18.2.2" data-path="inferential-error-and-statistical-power.html"><a href="inferential-error-and-statistical-power.html#decrease-the-variance-of-h_0-and-h_1"><i class="fa fa-check"></i><b>18.2.2</b> Decrease the variance of <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span></a></li>
<li class="chapter" data-level="18.2.3" data-path="inferential-error-and-statistical-power.html"><a href="inferential-error-and-statistical-power.html#power-as-a-function-of-sample-size"><i class="fa fa-check"></i><b>18.2.3</b> Power as a function of sample size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>19</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="19.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-for-two-tailed-tests"><i class="fa fa-check"></i><b>19.1</b> Confidence intervals for two-tailed tests</a></li>
<li class="chapter" data-level="19.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-for-one-tailed-tests"><i class="fa fa-check"></i><b>19.2</b> Confidence intervals for one-tailed tests</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="normal-test.html"><a href="normal-test.html"><i class="fa fa-check"></i><b>20</b> Normal test</a>
<ul>
<li class="chapter" data-level="20.1" data-path="normal-test.html"><a href="normal-test.html#two-tailed-normal-test"><i class="fa fa-check"></i><b>20.1</b> Two-tailed Normal test</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="z-test.html"><a href="z-test.html"><i class="fa fa-check"></i><b>21</b> Z-test</a></li>
<li class="chapter" data-level="22" data-path="t-test.html"><a href="t-test.html"><i class="fa fa-check"></i><b>22</b> t-test</a>
<ul>
<li class="chapter" data-level="22.1" data-path="t-test.html"><a href="t-test.html#two-tailed-t-test"><i class="fa fa-check"></i><b>22.1</b> Two-tailed t-test</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="independent-samples-t-test.html"><a href="independent-samples-t-test.html"><i class="fa fa-check"></i><b>23</b> Independent samples t-test</a>
<ul>
<li class="chapter" data-level="23.0.1" data-path="independent-samples-t-test.html"><a href="independent-samples-t-test.html#equal-sample-size-and-equal-variance"><i class="fa fa-check"></i><b>23.0.1</b> Equal sample size and equal variance</a></li>
<li class="chapter" data-level="23.0.2" data-path="independent-samples-t-test.html"><a href="independent-samples-t-test.html#unequal-sample-sizes-and-equal-variances"><i class="fa fa-check"></i><b>23.0.2</b> Unequal sample sizes and equal variances</a></li>
<li class="chapter" data-level="23.0.3" data-path="independent-samples-t-test.html"><a href="independent-samples-t-test.html#unequal-sample-size-and-unequal-variance"><i class="fa fa-check"></i><b>23.0.3</b> Unequal sample size and unequal variance</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="paired-samples-t-test.html"><a href="paired-samples-t-test.html"><i class="fa fa-check"></i><b>24</b> Paired samples t-test</a></li>
<li class="chapter" data-level="25" data-path="binomial-test.html"><a href="binomial-test.html"><i class="fa fa-check"></i><b>25</b> Binomial Test</a></li>
<li class="chapter" data-level="26" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>26</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="26.1" data-path="one-way-anova.html"><a href="one-way-anova.html#learning-objectives-10"><i class="fa fa-check"></i><b>26.1</b> Learning objectives</a></li>
<li class="chapter" data-level="26.2" data-path="one-way-anova.html"><a href="one-way-anova.html#introduction-1"><i class="fa fa-check"></i><b>26.2</b> Introduction</a></li>
<li class="chapter" data-level="26.3" data-path="one-way-anova.html"><a href="one-way-anova.html#intuition"><i class="fa fa-check"></i><b>26.3</b> Intuition</a></li>
<li class="chapter" data-level="26.4" data-path="one-way-anova.html"><a href="one-way-anova.html#formal-treatment"><i class="fa fa-check"></i><b>26.4</b> Formal treatment</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="one-way-anova.html"><a href="one-way-anova.html#what-is-an-f-distribution"><i class="fa fa-check"></i><b>26.4.1</b> What is an F distribution?</a></li>
<li class="chapter" data-level="26.4.2" data-path="one-way-anova.html"><a href="one-way-anova.html#assumptions"><i class="fa fa-check"></i><b>26.4.2</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="one-way-anova.html"><a href="one-way-anova.html#example-1-made-up-data"><i class="fa fa-check"></i><b>26.5</b> Example 1: Made up data</a></li>
<li class="chapter" data-level="26.6" data-path="one-way-anova.html"><a href="one-way-anova.html#example-2-criterion-learning-data"><i class="fa fa-check"></i><b>26.6</b> Example 2: Criterion learning data</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="two-way-anova.html"><a href="two-way-anova.html"><i class="fa fa-check"></i><b>27</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="27.1" data-path="two-way-anova.html"><a href="two-way-anova.html#two-way-anova-intuition"><i class="fa fa-check"></i><b>27.1</b> Two-way ANOVA Intuition</a></li>
<li class="chapter" data-level="27.2" data-path="two-way-anova.html"><a href="two-way-anova.html#visualising-the-three-null-hypotheses"><i class="fa fa-check"></i><b>27.2</b> Visualising the three null hypotheses</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="two-way-anova.html"><a href="two-way-anova.html#example-1---no-main-effects-and-no-interaction"><i class="fa fa-check"></i><b>27.2.1</b> Example 1 - No main effects and no interaction</a></li>
<li class="chapter" data-level="27.2.2" data-path="two-way-anova.html"><a href="two-way-anova.html#example-2---no-main-effects-but-with-an-interaction"><i class="fa fa-check"></i><b>27.2.2</b> Example 2 - No main effects but with an interaction</a></li>
<li class="chapter" data-level="27.2.3" data-path="two-way-anova.html"><a href="two-way-anova.html#example-3---two-main-effects-but-no-interaction"><i class="fa fa-check"></i><b>27.2.3</b> Example 3 - Two main effects but no interaction</a></li>
<li class="chapter" data-level="27.2.4" data-path="two-way-anova.html"><a href="two-way-anova.html#example-4---two-main-effects-and-an-interaction"><i class="fa fa-check"></i><b>27.2.4</b> Example 4 - Two main effects and an interaction</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="two-way-anova.html"><a href="two-way-anova.html#two-way-anova-more-formally"><i class="fa fa-check"></i><b>27.3</b> Two-way ANOVA more formally</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="two-way-anova.html"><a href="two-way-anova.html#using-variance-to-test-the-null-hypotheses"><i class="fa fa-check"></i><b>27.3.1</b> Using variance to test the null hypotheses</a></li>
<li class="chapter" data-level="27.3.2" data-path="two-way-anova.html"><a href="two-way-anova.html#variability-terms-akin-to-between-factor-variability"><i class="fa fa-check"></i><b>27.3.2</b> Variability terms akin to <em>between-factor</em> variability</a></li>
<li class="chapter" data-level="27.3.3" data-path="two-way-anova.html"><a href="two-way-anova.html#variability-terms-akin-to-within-factor-variability"><i class="fa fa-check"></i><b>27.3.3</b> Variability terms akin to <em>within-factor</em> variability</a></li>
<li class="chapter" data-level="27.3.4" data-path="two-way-anova.html"><a href="two-way-anova.html#total-variability"><i class="fa fa-check"></i><b>27.3.4</b> Total variability</a></li>
<li class="chapter" data-level="27.3.5" data-path="two-way-anova.html"><a href="two-way-anova.html#degrees-of-freedom-and-building-f-ratios"><i class="fa fa-check"></i><b>27.3.5</b> Degrees of freedom and building F-ratios</a></li>
<li class="chapter" data-level="27.3.6" data-path="two-way-anova.html"><a href="two-way-anova.html#more-general-experiment-and-data-structure"><i class="fa fa-check"></i><b>27.3.6</b> More general experiment and data structure</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="two-way-anova.html"><a href="two-way-anova.html#two-way-anova-in-r"><i class="fa fa-check"></i><b>27.4</b> Two-way ANOVA in R</a></li>
<li class="chapter" data-level="27.5" data-path="two-way-anova.html"><a href="two-way-anova.html#two-way-anova-in-r-using-real-data"><i class="fa fa-check"></i><b>27.5</b> Two-way ANOVA in R using real data</a></li>
<li class="chapter" data-level="27.6" data-path="two-way-anova.html"><a href="two-way-anova.html#unbalanced-designs"><i class="fa fa-check"></i><b>27.6</b> Unbalanced designs</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>28</b> Repeated measures ANOVA</a>
<ul>
<li class="chapter" data-level="28.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#intuition-1"><i class="fa fa-check"></i><b>28.1</b> Intuition</a></li>
<li class="chapter" data-level="28.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#formal-treatment-1"><i class="fa fa-check"></i><b>28.2</b> Formal treatment</a></li>
<li class="chapter" data-level="28.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-in-r"><i class="fa fa-check"></i><b>28.3</b> Repeated measures ANOVA in R</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#toy-example"><i class="fa fa-check"></i><b>28.3.1</b> toy example</a></li>
<li class="chapter" data-level="28.3.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#real-data"><i class="fa fa-check"></i><b>28.3.2</b> Real data</a></li>
<li class="chapter" data-level="28.3.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#making-sense-of-ezanova-output"><i class="fa fa-check"></i><b>28.3.3</b> Making sense of <code>ezANOVA</code> output</a></li>
<li class="chapter" data-level="28.3.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#quick-note-on-balanced-versus-unbalanced-data"><i class="fa fa-check"></i><b>28.3.4</b> Quick note on balanced versus unbalanced data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html"><i class="fa fa-check"></i><b>29</b> Mixed-design ANOVA</a>
<ul>
<li class="chapter" data-level="29.1" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html#toy-example-1"><i class="fa fa-check"></i><b>29.1</b> Toy example</a></li>
<li class="chapter" data-level="29.2" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html#real-data-1"><i class="fa fa-check"></i><b>29.2</b> Real data</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>30</b> Simple linear regression</a></li>
<li class="chapter" data-level="31" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>31</b> Multiple Regression</a></li>
<li class="chapter" data-level="32" data-path="general-linear-model-glm.html"><a href="general-linear-model-glm.html"><i class="fa fa-check"></i><b>32</b> General linear model (GLM)</a>
<ul>
<li class="chapter" data-level="32.1" data-path="general-linear-model-glm.html"><a href="general-linear-model-glm.html#general-linear-model-anova-and-regression-have-a-common-base"><i class="fa fa-check"></i><b>32.1</b> General linear model: ANOVA and regression have a common base</a></li>
<li class="chapter" data-level="32.2" data-path="general-linear-model-glm.html"><a href="general-linear-model-glm.html#rat-maze-data"><i class="fa fa-check"></i><b>32.2</b> Rat maze data</a></li>
<li class="chapter" data-level="32.3" data-path="general-linear-model-glm.html"><a href="general-linear-model-glm.html#criterion-learning-data"><i class="fa fa-check"></i><b>32.3</b> Criterion learning data</a></li>
<li class="chapter" data-level="32.4" data-path="general-linear-model-glm.html"><a href="general-linear-model-glm.html#nhp-data"><i class="fa fa-check"></i><b>32.4</b> NHP data</a></li>
<li class="chapter" data-level="32.5" data-path="general-linear-model-glm.html"><a href="general-linear-model-glm.html#minimally-invasive-surgery-mis-data"><i class="fa fa-check"></i><b>32.5</b> Minimally invasive surgery (MIS) data</a></li>
<li class="chapter" data-level="32.6" data-path="general-linear-model-glm.html"><a href="general-linear-model-glm.html#meg-data"><i class="fa fa-check"></i><b>32.6</b> MEG data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data analysis and statistics for cognitive neuroscience</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-way-anova" class="section level1 hasAnchor" number="27">
<h1><span class="header-section-number">27</span> Two-way ANOVA<a href="two-way-anova.html#two-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Consider an experiment in which one of two different
<strong>treatments</strong> are administered at one of two different
<strong>doses</strong>. A two-way ANOVA attempts to answer the following
three questions:</p>
<ol style="list-style-type: decimal">
<li>Do different treatments lead to different outcomes?</li>
<li>Do different doses lead to different outcomes?</li>
<li>Does treatment and dose interact?</li>
</ol>
<div id="two-way-anova-intuition" class="section level2 hasAnchor" number="27.1">
<h2><span class="header-section-number">27.1</span> Two-way ANOVA Intuition<a href="two-way-anova.html#two-way-anova-intuition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The logic of a two-way ANOVA is essentially the same as for
a one-way ANOVA. That is, if between-group variation is
significantly larger than within-group variation, then we
have evidence that different groups have different means.
However, with a two-way ANOVA, between-group and
withing-group arenâ€™t quite as easily defined, because there
are many groups for observations to fall between or within.
The basic approach to dealing with this is to see that a
two-way ANOVA is actually testing three null hypotheses
simultaneously (i.e., the three statements above).</p>
</div>
<div id="visualising-the-three-null-hypotheses" class="section level2 hasAnchor" number="27.2">
<h2><span class="header-section-number">27.2</span> Visualising the three null hypotheses<a href="two-way-anova.html#visualising-the-three-null-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider the simple example of two treatments <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>,
both with two treatment doses.</p>
<div id="example-1---no-main-effects-and-no-interaction" class="section level3 hasAnchor row" number="27.2.1">
<h3><span class="header-section-number">27.2.1</span> Example 1 - No main effects and no interaction<a href="two-way-anova.html#example-1---no-main-effects-and-no-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
</div>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
</div>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
</div>
</div>
<div id="example-2---no-main-effects-but-with-an-interaction" class="section level3 hasAnchor row" number="27.2.2">
<h3><span class="header-section-number">27.2.2</span> Example 2 - No main effects but with an interaction<a href="two-way-anova.html#example-2---no-main-effects-but-with-an-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
</div>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
</div>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
</div>
</div>
<div id="example-3---two-main-effects-but-no-interaction" class="section level3 hasAnchor row" number="27.2.3">
<h3><span class="header-section-number">27.2.3</span> Example 3 - Two main effects but no interaction<a href="two-way-anova.html#example-3---two-main-effects-but-no-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
</div>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
</div>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
</div>
<div id="example-4---two-main-effects-and-an-interaction" class="section level3 hasAnchor row" number="27.2.4">
<h3><span class="header-section-number">27.2.4</span> Example 4 - Two main effects and an interaction<a href="two-way-anova.html#example-4---two-main-effects-and-an-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
</div>
<div class="col-md-4">
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="two-way-anova-more-formally" class="section level2 hasAnchor" number="27.3">
<h2><span class="header-section-number">27.3</span> Two-way ANOVA more formally<a href="two-way-anova.html#two-way-anova-more-formally" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To talk about a two-way ANOVA clearly, it is helpful to
introduce the following new nomenclature:</p>
<ul>
<li><p>Let <span class="math inline">\(y_{ijk}\)</span> be the <span class="math inline">\(k^{th}\)</span> observation obtained for
treatment <span class="math inline">\(i\)</span> and dose <span class="math inline">\(j\)</span>. In this example, <span class="math inline">\(i \in \{A, B\}\)</span>, <span class="math inline">\(j \in \{1, 2\}\)</span>, and <span class="math inline">\(k \in \{1,2,...,n_{i,j}\}\)</span>,
where <span class="math inline">\(n_{i,j}\)</span> is the number of observations in the
corresponding condition.</p></li>
<li><p>Let <span class="math inline">\(\bar{y}_{ij \bullet}\)</span> indicate the mean effect
observed for treatment <span class="math inline">\(i\)</span> and dose <span class="math inline">\(j\)</span>.</p></li>
<li><p>Let <span class="math inline">\(\bar{y}_{\bullet j \bullet}\)</span> indicate the mean effect
observed for dose <span class="math inline">\(j\)</span>, averaged over all possible
treatments.</p></li>
<li><p>Let <span class="math inline">\(\bar{y}_{i \bullet \bullet}\)</span> indicate the mean effect
observed for treatment <span class="math inline">\(i\)</span>, averaged over all possible
doses.</p></li>
<li><p>Let <span class="math inline">\(\bar{y}_{\bullet \bullet \bullet}\)</span> indicate the mean
averaged over all possible treatments and doses.</p></li>
</ul>
<p>For this simple case in which we have only two treatments
<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, only two doses, and we have exactly <span class="math inline">\(n\)</span>
observations for each treatment at each dose, our data looks
as follows:</p>
<table>
<colgroup>
<col width="19%" />
<col width="26%" />
<col width="26%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Treatment A</th>
<th align="center">Treatment B</th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Dose 1</td>
<td align="center"><span class="math inline">\(\bar{y}_{11\bullet} = \frac{y_{111}+y_{112}+\ldots+y_{11n}}{n}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{21\bullet} = \frac{y_{121}+y_{122}+\ldots+y_{12n}}{n}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{\bullet 1 \bullet}\)</span></td>
</tr>
<tr class="even">
<td align="center">Dose 2</td>
<td align="center"><span class="math inline">\(\bar{y}_{12\bullet} = \frac{y_{211}+y_{212}+\ldots+y_{11n}}{n}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{22\bullet} = \frac{y_{221}+y_{222}+\ldots+y_{22n}}{n}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{\bullet 2 \bullet}\)</span></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(\bar{y}_{1 \bullet \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{2 \bullet \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{\bullet \bullet \bullet}\)</span></td>
</tr>
</tbody>
</table>
<p>Please note that this is called a <strong><a href="https://en.wikipedia.org/wiki/Factorial_experiment">full factorial
experiment</a></strong>.</p>
<p>With this convention, we can write the Hâ€™s as follows:</p>
<p><span class="math inline">\(\begin{align} &amp; H_{0_1}: \mu_{Treatment_A} = \mu_{Treatment_B} \\ &amp; H_{0_2}: \mu_{Dose_1} = \mu_{Dose_2} \\ &amp; H_{0_3}: \mu_{Treatment_i | Dose_j} = \mu_{Treatment_i | Dose_j} \\\\ &amp; H_1: \lnot H_0 \\ \end{align}\)</span></p>
<div id="using-variance-to-test-the-null-hypotheses" class="section level3 hasAnchor" number="27.3.1">
<h3><span class="header-section-number">27.3.1</span> Using variance to test the null hypotheses<a href="two-way-anova.html#using-variance-to-test-the-null-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><span class="math inline">\(SS_{total}\)</span> is the total variability between all
observations.</li>
<li><span class="math inline">\(SS_{treatment}\)</span> is the variability between different
treatments.</li>
<li><span class="math inline">\(SS_{dose}\)</span> is the variability between different doses.</li>
<li><span class="math inline">\(SS_{treatment \times dose}\)</span> is the variability between
different treatments at different dose levels.</li>
<li><span class="math inline">\(SS_{error}\)</span> is the variability not accounted for by
<span class="math inline">\(SS_{treatment}\)</span>, <span class="math inline">\(SS_{dose}\)</span>, and <span class="math inline">\(SS_{treatment \times dose}\)</span></li>
</ul>
</div>
<div id="variability-terms-akin-to-between-factor-variability" class="section level3 hasAnchor" number="27.3.2">
<h3><span class="header-section-number">27.3.2</span> Variability terms akin to <em>between-factor</em> variability<a href="two-way-anova.html#variability-terms-akin-to-between-factor-variability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><span class="math inline">\(n_{treatment} =\)</span> number of unique treatment levels.</li>
<li><span class="math inline">\(n_{dose} =\)</span> number of unique dose levels.</li>
<li><span class="math inline">\(n_{total} =\)</span> number of observations at level of dose and
treatment, which in the following we assume is the same for
all combinations of treatment and dose (i.e., we assume a
<strong>balanced design</strong>).</li>
</ul>
<p><span class="math display">\[\begin{align}
SS_{treatment} &amp;= n_{dose} n_{total} \sum_i^{ n_{treatment} }
                               (\bar{y}_{i \bullet \bullet} -
                                \bar{y}_{\bullet \bullet \bullet})^2 \\

SS_{dose} &amp;= n_{treatment} n_{total} \sum_j^{ n_{dose} } (\bar{y}_{\bullet j \bullet} -
                                \bar{y}_{\bullet \bullet \bullet})^2 \\

SS_{treatment \times dose} &amp;= n_{total} \sum_i^{ n_{treatment} } \sum_j^{ n_{dose} }
                                  \left(
                                  \bar{y}_{i j \bullet} -
                                  (\bar{y}_{i \bullet \bullet} +
                                  \bar{y}_{\bullet j \bullet} -
                                  \bar{y}_{\bullet \bullet \bullet} )
                                  \right)^2 \\
\end{align}\]</span></p>
</div>
<div id="variability-terms-akin-to-within-factor-variability" class="section level3 hasAnchor" number="27.3.3">
<h3><span class="header-section-number">27.3.3</span> Variability terms akin to <em>within-factor</em> variability<a href="two-way-anova.html#variability-terms-akin-to-within-factor-variability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[\begin{align}
SS_{error} &amp;= \sum_i^{ n_{treatment} } \sum_j^{ n_{dose} } \sum_k^{ n_{total} }
                             \left(
                             \bar{y}_{i j k} -
                             \bar{y}_{i j \bullet}
                             \right)^2 \\
\end{align}\]</span></p>
</div>
<div id="total-variability" class="section level3 hasAnchor" number="27.3.4">
<h3><span class="header-section-number">27.3.4</span> Total variability<a href="two-way-anova.html#total-variability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[\begin{align}
SS_{Total} &amp;= \sum_i^{ n_{treatment} } \sum_j^{ n_{dose} } \sum_k^{ n_{total} }
                             \left(
                             \bar{y}_{i j k} -
                             \bar{y}_{\bullet \bullet \bullet}
                             \right)^2 \\
\end{align}\]</span></p>
<ul>
<li>Note that you can think of the <span class="math inline">\(n_{treatment}\)</span>,
<span class="math inline">\(n_{dose}\)</span>, and <span class="math inline">\(n_{total}\)</span> multipliers above serve to cast
each <span class="math inline">\(SS\)</span> term into the same units so that they can be
meaningfully compared. You can also think of them as
ensuring that <span class="math inline">\(SS_{total}\)</span> is the sum of all the other
sources of variability.</li>
</ul>
<p><span class="math display">\[SS_{total} = SS_{treatment} + SS_{dose} + SS_{treatment \times dose} + SS_{error}\]</span></p>
</div>
<div id="degrees-of-freedom-and-building-f-ratios" class="section level3 hasAnchor" number="27.3.5">
<h3><span class="header-section-number">27.3.5</span> Degrees of freedom and building F-ratios<a href="two-way-anova.html#degrees-of-freedom-and-building-f-ratios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Effect</th>
<th align="center"><span class="math inline">\(df\)</span></th>
<th align="center"><span class="math inline">\(SS\)</span></th>
<th align="center"><span class="math inline">\(MS\)</span></th>
<th align="center"><span class="math inline">\(F\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(Treatment\)</span></td>
<td align="center"><span class="math inline">\(n_{treatment} - 1\)</span></td>
<td align="center">see above</td>
<td align="center"><span class="math inline">\(\frac{SS_{treatment}}{df_{treatment}}\)</span></td>
<td align="center"><span class="math inline">\(\frac{MS_{treatment}}{MS_{error}}\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Dose\)</span></td>
<td align="center"><span class="math inline">\(n_{dose} - 1\)</span></td>
<td align="center">see above</td>
<td align="center"><span class="math inline">\(\frac{SS_{dose}}{df_{dose}}\)</span></td>
<td align="center"><span class="math inline">\(\frac{MS_{dose}}{MS_{error}}\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(Treatment \times Dose\)</span></td>
<td align="center"><span class="math inline">\((n_{treatment} - 1)(n_{dose} - 1)\)</span></td>
<td align="center">see above</td>
<td align="center"><span class="math inline">\(\frac{SS_{treatment \times dose}}{df_{treatment \times dose}}\)</span></td>
<td align="center"><span class="math inline">\(\frac{MS_{treatment \times dose}}{MS_{error}}\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Error\)</span></td>
<td align="center"><span class="math inline">\(N - n_{treatment}n_{dose}\)</span></td>
<td align="center">see above</td>
<td align="center"><span class="math inline">\(\frac{SS_{error}}{df_{error}}\)</span></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<ul>
<li>From here, we compute p-values from the observed <span class="math inline">\(F\)</span>
scores in the table above, and we are off to the hypothesis
testing races.</li>
</ul>
</div>
<div id="more-general-experiment-and-data-structure" class="section level3 hasAnchor" number="27.3.6">
<h3><span class="header-section-number">27.3.6</span> More general experiment and data structure<a href="two-way-anova.html#more-general-experiment-and-data-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>More generally, two-way ANOVA deals with any two factors of
an experiment that contain an arbitrary number of levels.
Consider a full factorial experiment with two factors:
Factor 1 containing <span class="math inline">\(n_1\)</span> levels and Factor 2 containing
<span class="math inline">\(n_2\)</span> levels.</p>
<table style="width:100%;">
<colgroup>
<col width="12%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Factor 2 level 1</th>
<th align="center">Factor 2 level 2</th>
<th align="center"><span class="math inline">\(\ldots\)</span></th>
<th align="center">Factor 2 level <span class="math inline">\(n_1\)</span></th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Factor 1 level 1</td>
<td align="center"><span class="math inline">\(\bar{y}_{11\bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{12\bullet}\)</span></td>
<td align="center"><span class="math inline">\(\ldots\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{1 n_2 \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{1 \bullet \bullet}\)</span></td>
</tr>
<tr class="even">
<td align="center">Factor 1 level 2</td>
<td align="center"><span class="math inline">\(\bar{y}_{21\bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{22\bullet}\)</span></td>
<td align="center"><span class="math inline">\(\ldots\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{2 n_2 \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{2 \bullet \bullet}\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td align="center">Factor 1 level <span class="math inline">\(n_1\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{n_1 1 \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{n_1 2 \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\ldots\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{n_1 n_2 \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{n_1 \bullet \bullet}\)</span></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(\bar{y}_{\bullet 1 \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{\bullet 2 \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\ldots\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{\bullet n_2 \bullet}\)</span></td>
<td align="center"><span class="math inline">\(\bar{y}_{\bullet \bullet \bullet}\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li>This more general situation doesnâ€™t change our method at all.</li>
<li>We still proceed by generating the ANOVA table:</li>
</ul>
<table>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Effect</th>
<th align="center"><span class="math inline">\(df\)</span></th>
<th align="center"><span class="math inline">\(SS\)</span></th>
<th align="center"><span class="math inline">\(MS\)</span></th>
<th align="center"><span class="math inline">\(F\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(Factor 1\)</span></td>
<td align="center"><span class="math inline">\(n_{Factor 1} - 1\)</span></td>
<td align="center">see above</td>
<td align="center"><span class="math inline">\(\frac{SS_{Factor 1}}{df_{Factor 1}}\)</span></td>
<td align="center"><span class="math inline">\(\frac{MS_{Factor 1}}{MS_{error}}\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Factor 2\)</span></td>
<td align="center"><span class="math inline">\(n_{Factor 2} - 1\)</span></td>
<td align="center">see above</td>
<td align="center"><span class="math inline">\(\frac{SS_{Factor 2}}{df_{Factor 2}}\)</span></td>
<td align="center"><span class="math inline">\(\frac{MS_{Factor 2}}{MS_{error}}\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(Factor 1 \times Factor 2\)</span></td>
<td align="center"><span class="math inline">\((n_{Factor 1}-1) (n_{Factor 2}-1)\)</span></td>
<td align="center">see above</td>
<td align="center"><span class="math inline">\(\frac{SS_{Factor 1 \times Factor 2}}{df_{Factor 1 \times Factor 2}}\)</span></td>
<td align="center"><span class="math inline">\(\frac{MS_{Factor 1 \times Factor 2}}{MS_{error}}\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Error\)</span></td>
<td align="center"><span class="math inline">\(N - n_{Factor 1}n_{Factor 2}\)</span></td>
<td align="center">see above</td>
<td align="center"><span class="math inline">\(\frac{SS_{error}}{df_{error}}\)</span></td>
<td align="center"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="two-way-anova-in-r" class="section level2 hasAnchor" number="27.4">
<h2><span class="header-section-number">27.4</span> Two-way ANOVA in R<a href="two-way-anova.html#two-way-anova-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider the following data:</p>
<pre><code>##             y treatment dose
##  1: 16.314771         A    1
##  2:  8.368833         A    1
##  3: 16.648996         A    1
##  4: 16.362147         A    1
##  5: 32.073207         A    2
##  6: 22.300250         A    2
##  7: 25.357165         A    2
##  8: 28.526398         A    2
##  9: 19.971164         B    1
## 10: 32.023267         B    1
## 11: 23.817967         B    1
## 12: 16.004954         B    1
## 13: 34.261715         B    2
## 14: 38.552692         B    2
## 15: 38.503924         B    2
## 16: 37.942446         B    2</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="two-way-anova.html#cb283-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">16.314771</span>, <span class="fl">8.368833</span>, <span class="fl">16.648996</span>, <span class="fl">16.362147</span>, </span>
<span id="cb283-2"><a href="two-way-anova.html#cb283-2" tabindex="-1"></a>       <span class="fl">32.073207</span>, <span class="fl">22.300250</span>, <span class="fl">25.357165</span>, <span class="fl">28.526398</span>, </span>
<span id="cb283-3"><a href="two-way-anova.html#cb283-3" tabindex="-1"></a>       <span class="fl">19.971164</span>, <span class="fl">32.023267</span>, <span class="fl">23.817967</span>, <span class="fl">16.004954</span>, </span>
<span id="cb283-4"><a href="two-way-anova.html#cb283-4" tabindex="-1"></a>       <span class="fl">34.261715</span>, <span class="fl">38.552692</span>, <span class="fl">38.503924</span>, <span class="fl">37.942446</span>)</span>
<span id="cb283-5"><a href="two-way-anova.html#cb283-5" tabindex="-1"></a></span>
<span id="cb283-6"><a href="two-way-anova.html#cb283-6" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>,</span>
<span id="cb283-7"><a href="two-way-anova.html#cb283-7" tabindex="-1"></a>                <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>,  <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>)</span>
<span id="cb283-8"><a href="two-way-anova.html#cb283-8" tabindex="-1"></a></span>
<span id="cb283-9"><a href="two-way-anova.html#cb283-9" tabindex="-1"></a>dose <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb283-10"><a href="two-way-anova.html#cb283-10" tabindex="-1"></a></span>
<span id="cb283-11"><a href="two-way-anova.html#cb283-11" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">y=</span>y, </span>
<span id="cb283-12"><a href="two-way-anova.html#cb283-12" tabindex="-1"></a>                <span class="at">treatment=</span><span class="fu">as.factor</span>(treatment), </span>
<span id="cb283-13"><a href="two-way-anova.html#cb283-13" tabindex="-1"></a>                <span class="at">dose=</span><span class="fu">as.factor</span>(dose))</span>
<span id="cb283-14"><a href="two-way-anova.html#cb283-14" tabindex="-1"></a></span>
<span id="cb283-15"><a href="two-way-anova.html#cb283-15" tabindex="-1"></a><span class="co"># generate intuition about results before doing the analysis</span></span>
<span id="cb283-16"><a href="two-way-anova.html#cb283-16" tabindex="-1"></a><span class="co"># (looks like two main effects but no interaction)</span></span>
<span id="cb283-17"><a href="two-way-anova.html#cb283-17" tabindex="-1"></a>dd <span class="ot">&lt;-</span> d[, .(<span class="fu">mean</span>(y), <span class="fu">sd</span>(y)<span class="sc">/</span><span class="fu">sqrt</span>(.N)), .(treatment, dose)]</span>
<span id="cb283-18"><a href="two-way-anova.html#cb283-18" tabindex="-1"></a><span class="fu">ggplot</span>(dd, <span class="fu">aes</span>(treatment, V1, <span class="at">colour=</span>dose)) <span class="sc">+</span></span>
<span id="cb283-19"><a href="two-way-anova.html#cb283-19" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>V1<span class="sc">-</span>V2, <span class="at">ymax=</span>V1<span class="sc">+</span>V2))</span></code></pre></div>
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="two-way-anova.html#cb284-1" tabindex="-1"></a><span class="do">## define number of levels in each factor</span></span>
<span id="cb284-2"><a href="two-way-anova.html#cb284-2" tabindex="-1"></a>n_treatment <span class="ot">&lt;-</span> d[, <span class="fu">length</span>(<span class="fu">unique</span>(treatment))] <span class="co"># number of treatment levels</span></span>
<span id="cb284-3"><a href="two-way-anova.html#cb284-3" tabindex="-1"></a>n_dose <span class="ot">&lt;-</span> d[, <span class="fu">length</span>(<span class="fu">unique</span>(dose))] <span class="co"># number of dose levels</span></span>
<span id="cb284-4"><a href="two-way-anova.html#cb284-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> d[, .N, .(treatment, dose)][, <span class="fu">unique</span>(N)] <span class="co"># number of observations at each level</span></span>
<span id="cb284-5"><a href="two-way-anova.html#cb284-5" tabindex="-1"></a></span>
<span id="cb284-6"><a href="two-way-anova.html#cb284-6" tabindex="-1"></a><span class="do">## define Df terms</span></span>
<span id="cb284-7"><a href="two-way-anova.html#cb284-7" tabindex="-1"></a>df_treatment <span class="ot">&lt;-</span> n_treatment <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb284-8"><a href="two-way-anova.html#cb284-8" tabindex="-1"></a>df_dose <span class="ot">&lt;-</span> n_dose <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb284-9"><a href="two-way-anova.html#cb284-9" tabindex="-1"></a>df_interaction <span class="ot">&lt;-</span> df_treatment <span class="sc">*</span> df_dose</span>
<span id="cb284-10"><a href="two-way-anova.html#cb284-10" tabindex="-1"></a>df_error <span class="ot">&lt;-</span> d[, .N] <span class="sc">-</span> n_treatment<span class="sc">*</span>n_dose</span>
<span id="cb284-11"><a href="two-way-anova.html#cb284-11" tabindex="-1"></a></span>
<span id="cb284-12"><a href="two-way-anova.html#cb284-12" tabindex="-1"></a><span class="do">## Define SS terms</span></span>
<span id="cb284-13"><a href="two-way-anova.html#cb284-13" tabindex="-1"></a>ss_treatment <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb284-14"><a href="two-way-anova.html#cb284-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> d[, <span class="fu">unique</span>(treatment)]) {</span>
<span id="cb284-15"><a href="two-way-anova.html#cb284-15" tabindex="-1"></a>  ss_treatment <span class="ot">&lt;-</span> ss_treatment <span class="sc">+</span> (d[treatment<span class="sc">==</span>i, <span class="fu">mean</span>(y)] <span class="sc">-</span> d[, <span class="fu">mean</span>(y)])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb284-16"><a href="two-way-anova.html#cb284-16" tabindex="-1"></a>}</span>
<span id="cb284-17"><a href="two-way-anova.html#cb284-17" tabindex="-1"></a>ss_treatment <span class="ot">&lt;-</span> n_dose <span class="sc">*</span> n <span class="sc">*</span> ss_treatment</span>
<span id="cb284-18"><a href="two-way-anova.html#cb284-18" tabindex="-1"></a></span>
<span id="cb284-19"><a href="two-way-anova.html#cb284-19" tabindex="-1"></a>ss_dose <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb284-20"><a href="two-way-anova.html#cb284-20" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> d[, <span class="fu">unique</span>(dose)]) {</span>
<span id="cb284-21"><a href="two-way-anova.html#cb284-21" tabindex="-1"></a>  ss_dose <span class="ot">&lt;-</span> ss_dose <span class="sc">+</span> (d[dose<span class="sc">==</span>i, <span class="fu">mean</span>(y)] <span class="sc">-</span> d[, <span class="fu">mean</span>(y)])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb284-22"><a href="two-way-anova.html#cb284-22" tabindex="-1"></a>}</span>
<span id="cb284-23"><a href="two-way-anova.html#cb284-23" tabindex="-1"></a>ss_dose <span class="ot">&lt;-</span> n_treatment <span class="sc">*</span> n <span class="sc">*</span> ss_dose</span>
<span id="cb284-24"><a href="two-way-anova.html#cb284-24" tabindex="-1"></a></span>
<span id="cb284-25"><a href="two-way-anova.html#cb284-25" tabindex="-1"></a>ss_interaction <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb284-26"><a href="two-way-anova.html#cb284-26" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> d[, <span class="fu">unique</span>(treatment)]) {</span>
<span id="cb284-27"><a href="two-way-anova.html#cb284-27" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> d[, <span class="fu">unique</span>(dose)]) {</span>
<span id="cb284-28"><a href="two-way-anova.html#cb284-28" tabindex="-1"></a>    ss_interaction <span class="ot">&lt;-</span> ss_interaction <span class="sc">+</span></span>
<span id="cb284-29"><a href="two-way-anova.html#cb284-29" tabindex="-1"></a>      (d[treatment<span class="sc">==</span>i <span class="sc">&amp;</span> dose<span class="sc">==</span>j, <span class="fu">mean</span>(y)] <span class="sc">-</span></span>
<span id="cb284-30"><a href="two-way-anova.html#cb284-30" tabindex="-1"></a>       (d[treatment<span class="sc">==</span>i, <span class="fu">mean</span>(y)] <span class="sc">+</span> d[dose<span class="sc">==</span>j, <span class="fu">mean</span>(y)] <span class="sc">-</span> d[, <span class="fu">mean</span>(y)]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb284-31"><a href="two-way-anova.html#cb284-31" tabindex="-1"></a>  }</span>
<span id="cb284-32"><a href="two-way-anova.html#cb284-32" tabindex="-1"></a>}</span>
<span id="cb284-33"><a href="two-way-anova.html#cb284-33" tabindex="-1"></a>ss_interaction <span class="ot">&lt;-</span> n <span class="sc">*</span> ss_interaction</span>
<span id="cb284-34"><a href="two-way-anova.html#cb284-34" tabindex="-1"></a></span>
<span id="cb284-35"><a href="two-way-anova.html#cb284-35" tabindex="-1"></a>ss_error <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb284-36"><a href="two-way-anova.html#cb284-36" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> d[, <span class="fu">unique</span>(treatment)]) {</span>
<span id="cb284-37"><a href="two-way-anova.html#cb284-37" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> d[, <span class="fu">unique</span>(dose)]) {</span>
<span id="cb284-38"><a href="two-way-anova.html#cb284-38" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb284-39"><a href="two-way-anova.html#cb284-39" tabindex="-1"></a>      ss_error <span class="ot">&lt;-</span> ss_error <span class="sc">+</span> (d[treatment<span class="sc">==</span>i <span class="sc">&amp;</span> dose<span class="sc">==</span>j][k, y] <span class="sc">-</span></span>
<span id="cb284-40"><a href="two-way-anova.html#cb284-40" tabindex="-1"></a>                              d[treatment<span class="sc">==</span>i <span class="sc">&amp;</span> dose<span class="sc">==</span>j, <span class="fu">mean</span>(y)])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb284-41"><a href="two-way-anova.html#cb284-41" tabindex="-1"></a>    }</span>
<span id="cb284-42"><a href="two-way-anova.html#cb284-42" tabindex="-1"></a>  }</span>
<span id="cb284-43"><a href="two-way-anova.html#cb284-43" tabindex="-1"></a>}</span>
<span id="cb284-44"><a href="two-way-anova.html#cb284-44" tabindex="-1"></a>ss_error <span class="ot">&lt;-</span> ss_error</span>
<span id="cb284-45"><a href="two-way-anova.html#cb284-45" tabindex="-1"></a></span>
<span id="cb284-46"><a href="two-way-anova.html#cb284-46" tabindex="-1"></a><span class="do">## Define MS terms</span></span>
<span id="cb284-47"><a href="two-way-anova.html#cb284-47" tabindex="-1"></a>ms_treatment <span class="ot">&lt;-</span> ss_treatment <span class="sc">/</span> df_treatment</span>
<span id="cb284-48"><a href="two-way-anova.html#cb284-48" tabindex="-1"></a>ms_dose <span class="ot">&lt;-</span> ss_dose <span class="sc">/</span> df_dose</span>
<span id="cb284-49"><a href="two-way-anova.html#cb284-49" tabindex="-1"></a>ms_interaction <span class="ot">&lt;-</span> ss_interaction <span class="sc">/</span> df_interaction</span>
<span id="cb284-50"><a href="two-way-anova.html#cb284-50" tabindex="-1"></a>ms_error <span class="ot">&lt;-</span> ss_error <span class="sc">/</span> df_error</span>
<span id="cb284-51"><a href="two-way-anova.html#cb284-51" tabindex="-1"></a></span>
<span id="cb284-52"><a href="two-way-anova.html#cb284-52" tabindex="-1"></a><span class="do">## Define F terms</span></span>
<span id="cb284-53"><a href="two-way-anova.html#cb284-53" tabindex="-1"></a>f_treatment <span class="ot">&lt;-</span> ms_treatment <span class="sc">/</span> ms_error</span>
<span id="cb284-54"><a href="two-way-anova.html#cb284-54" tabindex="-1"></a>f_dose <span class="ot">&lt;-</span> ms_dose <span class="sc">/</span> ms_error</span>
<span id="cb284-55"><a href="two-way-anova.html#cb284-55" tabindex="-1"></a>f_interaction <span class="ot">&lt;-</span> ms_interaction <span class="sc">/</span> ms_error</span>
<span id="cb284-56"><a href="two-way-anova.html#cb284-56" tabindex="-1"></a></span>
<span id="cb284-57"><a href="two-way-anova.html#cb284-57" tabindex="-1"></a><span class="do">## Define Pr(&gt;F)</span></span>
<span id="cb284-58"><a href="two-way-anova.html#cb284-58" tabindex="-1"></a>p_treatment <span class="ot">&lt;-</span> <span class="fu">pf</span>(f_treatment, df_treatment, df_error, <span class="at">lower.tail=</span>F)</span>
<span id="cb284-59"><a href="two-way-anova.html#cb284-59" tabindex="-1"></a>p_dose <span class="ot">&lt;-</span> <span class="fu">pf</span>(f_dose, df_dose, df_error, <span class="at">lower.tail=</span>F)</span>
<span id="cb284-60"><a href="two-way-anova.html#cb284-60" tabindex="-1"></a>p_interaction <span class="ot">&lt;-</span> <span class="fu">pf</span>(f_interaction, df_interaction, df_error, <span class="at">lower.tail=</span>F)</span>
<span id="cb284-61"><a href="two-way-anova.html#cb284-61" tabindex="-1"></a></span>
<span id="cb284-62"><a href="two-way-anova.html#cb284-62" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: Lots of things to print out here, so I&#39;ll leave</span></span>
<span id="cb284-63"><a href="two-way-anova.html#cb284-63" tabindex="-1"></a><span class="do">## this to a live demo and your own personal tinkering</span></span>
<span id="cb284-64"><a href="two-way-anova.html#cb284-64" tabindex="-1"></a><span class="do">## around to see the actual values and confirm that they</span></span>
<span id="cb284-65"><a href="two-way-anova.html#cb284-65" tabindex="-1"></a><span class="do">## match the anova() method below.</span></span>
<span id="cb284-66"><a href="two-way-anova.html#cb284-66" tabindex="-1"></a></span>
<span id="cb284-67"><a href="two-way-anova.html#cb284-67" tabindex="-1"></a><span class="do">## Verify results</span></span>
<span id="cb284-68"><a href="two-way-anova.html#cb284-68" tabindex="-1"></a>fm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> treatment<span class="sc">*</span>dose, <span class="at">data=</span>d)</span>
<span id="cb284-69"><a href="two-way-anova.html#cb284-69" tabindex="-1"></a><span class="fu">anova</span>(fm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##                Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## treatment       1 352.75  352.75 16.6240  0.001534 ** 
## dose            1 729.08  729.08 34.3593 7.697e-05 ***
## treatment:dose  1   2.96    2.96  0.1395  0.715325    
## Residuals      12 254.63   21.22                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="two-way-anova.html#cb286-1" tabindex="-1"></a><span class="co"># Using ezANOVA</span></span>
<span id="cb286-2"><a href="two-way-anova.html#cb286-2" tabindex="-1"></a>d[, subject <span class="sc">:=</span> <span class="dv">1</span><span class="sc">:</span>.N]</span>
<span id="cb286-3"><a href="two-way-anova.html#cb286-3" tabindex="-1"></a><span class="fu">ezANOVA</span>(<span class="at">data=</span>d,</span>
<span id="cb286-4"><a href="two-way-anova.html#cb286-4" tabindex="-1"></a>        <span class="at">dv=</span>y,</span>
<span id="cb286-5"><a href="two-way-anova.html#cb286-5" tabindex="-1"></a>        <span class="at">wid=</span>subject,</span>
<span id="cb286-6"><a href="two-way-anova.html#cb286-6" tabindex="-1"></a>        <span class="at">between=</span>.(treatment, dose),</span>
<span id="cb286-7"><a href="two-way-anova.html#cb286-7" tabindex="-1"></a>        <span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning: Converting &quot;subject&quot; to factor for ANOVA.</code></pre>
<pre><code>## Coefficient covariances computed by hccm()</code></pre>
<pre><code>## $ANOVA
##           Effect DFn DFd          F           p p&lt;.05        ges
## 2      treatment   1  12 16.6239881 1.53355e-03     * 0.58077121
## 3           dose   1  12 34.3592629 7.69696e-05     * 0.74115205
## 4 treatment:dose   1  12  0.1394674 7.15325e-01       0.01148876
## 
## $`Levene&#39;s Test for Homogeneity of Variance`
##   DFn DFd      SSn     SSd        F         p p&lt;.05
## 1   3  12 31.57735 113.392 1.113918 0.3818176</code></pre>
</div>
<div id="two-way-anova-in-r-using-real-data" class="section level2 hasAnchor" number="27.5">
<h2><span class="header-section-number">27.5</span> Two-way ANOVA in R using real data<a href="two-way-anova.html#two-way-anova-in-r-using-real-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="two-way-anova.html#cb290-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&#39;https://crossley.github.io/book_stats/data/mis/mis_data.csv&#39;</span>)</span>
<span id="cb290-2"><a href="two-way-anova.html#cb290-2" tabindex="-1"></a></span>
<span id="cb290-3"><a href="two-way-anova.html#cb290-3" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[phase<span class="sc">==</span><span class="st">&#39;Base&#39;</span>, .(subject, group, target, error)]</span>
<span id="cb290-4"><a href="two-way-anova.html#cb290-4" tabindex="-1"></a>d[, group <span class="sc">:=</span> <span class="fu">factor</span>(group)]</span>
<span id="cb290-5"><a href="two-way-anova.html#cb290-5" tabindex="-1"></a>d[, target <span class="sc">:=</span> <span class="fu">factor</span>(target)]</span>
<span id="cb290-6"><a href="two-way-anova.html#cb290-6" tabindex="-1"></a></span>
<span id="cb290-7"><a href="two-way-anova.html#cb290-7" tabindex="-1"></a><span class="do">## First, get one observation per subject per group per target</span></span>
<span id="cb290-8"><a href="two-way-anova.html#cb290-8" tabindex="-1"></a>dd <span class="ot">&lt;-</span> d[, <span class="fu">mean</span>(error), .(subject, group, target)]</span>
<span id="cb290-9"><a href="two-way-anova.html#cb290-9" tabindex="-1"></a></span>
<span id="cb290-10"><a href="two-way-anova.html#cb290-10" tabindex="-1"></a><span class="do">## Do different groups have different mean errors?</span></span>
<span id="cb290-11"><a href="two-way-anova.html#cb290-11" tabindex="-1"></a><span class="do">## Do different targets have different mean errors?</span></span>
<span id="cb290-12"><a href="two-way-anova.html#cb290-12" tabindex="-1"></a><span class="do">## Does target and group interact?</span></span>
<span id="cb290-13"><a href="two-way-anova.html#cb290-13" tabindex="-1"></a></span>
<span id="cb290-14"><a href="two-way-anova.html#cb290-14" tabindex="-1"></a><span class="do">## begin by making diagnostic plots</span></span>
<span id="cb290-15"><a href="two-way-anova.html#cb290-15" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> dd[, .(<span class="fu">mean</span>(V1), <span class="fu">sd</span>(V1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(<span class="fu">unique</span>(target)))), .(group)]</span>
<span id="cb290-16"><a href="two-way-anova.html#cb290-16" tabindex="-1"></a><span class="fu">ggplot</span>(ddd, <span class="fu">aes</span>(group, V1)) <span class="sc">+</span></span>
<span id="cb290-17"><a href="two-way-anova.html#cb290-17" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>V1<span class="sc">-</span>V2, <span class="at">ymax=</span>V1<span class="sc">+</span>V2))</span></code></pre></div>
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="two-way-anova.html#cb291-1" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> dd[, .(<span class="fu">mean</span>(V1), <span class="fu">sd</span>(V1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(<span class="fu">unique</span>(group)))), .(target)]</span>
<span id="cb291-2"><a href="two-way-anova.html#cb291-2" tabindex="-1"></a><span class="fu">ggplot</span>(ddd, <span class="fu">aes</span>(target, V1)) <span class="sc">+</span></span>
<span id="cb291-3"><a href="two-way-anova.html#cb291-3" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>V1<span class="sc">-</span>V2, <span class="at">ymax=</span>V1<span class="sc">+</span>V2))</span></code></pre></div>
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-174-2.png" width="672" /></p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="two-way-anova.html#cb292-1" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> dd[, .(<span class="fu">mean</span>(V1), <span class="fu">sd</span>(V1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(<span class="fu">unique</span>(target))<span class="sc">*</span><span class="fu">length</span>(<span class="fu">unique</span>(group)))), .(group, target)]</span>
<span id="cb292-2"><a href="two-way-anova.html#cb292-2" tabindex="-1"></a><span class="fu">ggplot</span>(ddd, <span class="fu">aes</span>(target, V1, <span class="at">colour=</span>group)) <span class="sc">+</span></span>
<span id="cb292-3"><a href="two-way-anova.html#cb292-3" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>V1<span class="sc">-</span>V2, <span class="at">ymax=</span>V1<span class="sc">+</span>V2), <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span>.<span class="dv">1</span>))</span></code></pre></div>
<p><img src="bookdown_files_files/figure-html/unnamed-chunk-174-3.png" width="672" /></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="two-way-anova.html#cb293-1" tabindex="-1"></a><span class="do">## To my eye, it looks like the effect of group ought to be</span></span>
<span id="cb293-2"><a href="two-way-anova.html#cb293-2" tabindex="-1"></a><span class="do">## significant, or pretty close to it, but that&#39;s probably</span></span>
<span id="cb293-3"><a href="two-way-anova.html#cb293-3" tabindex="-1"></a><span class="do">## about it.</span></span>
<span id="cb293-4"><a href="two-way-anova.html#cb293-4" tabindex="-1"></a></span>
<span id="cb293-5"><a href="two-way-anova.html#cb293-5" tabindex="-1"></a><span class="do">## Verify results</span></span>
<span id="cb293-6"><a href="two-way-anova.html#cb293-6" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&quot;contr.sum&quot;</span>,<span class="st">&quot;contr.poly&quot;</span>)) <span class="co"># type 3 ss</span></span>
<span id="cb293-7"><a href="two-way-anova.html#cb293-7" tabindex="-1"></a>fm <span class="ot">&lt;-</span> <span class="fu">lm</span>(V1 <span class="sc">~</span> group <span class="sc">*</span> target, <span class="at">data=</span>dd)</span>
<span id="cb293-8"><a href="two-way-anova.html#cb293-8" tabindex="-1"></a><span class="fu">anova</span>(fm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: V1
##               Df Sum Sq Mean Sq  F value Pr(&gt;F)    
## group          1 461.40  461.40 431.8110 &lt;2e-16 ***
## target        10  13.45    1.35   1.2589 0.2561    
## group:target  10  10.80    1.08   1.0106 0.4358    
## Residuals    198 211.57    1.07                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="two-way-anova.html#cb295-1" tabindex="-1"></a><span class="fu">ezANOVA</span>(<span class="at">data=</span>dd,</span>
<span id="cb295-2"><a href="two-way-anova.html#cb295-2" tabindex="-1"></a>        <span class="at">dv=</span>V1,</span>
<span id="cb295-3"><a href="two-way-anova.html#cb295-3" tabindex="-1"></a>        <span class="at">wid=</span>subject,</span>
<span id="cb295-4"><a href="two-way-anova.html#cb295-4" tabindex="-1"></a>        <span class="at">between=</span>.(group, target),</span>
<span id="cb295-5"><a href="two-way-anova.html#cb295-5" tabindex="-1"></a>        <span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning: Converting &quot;subject&quot; to factor for ANOVA.</code></pre>
<pre><code>## Warning: The column supplied as the wid variable contains non-unique values
## across levels of the supplied between-Ss variables. Automatically fixing this
## by generating unique wid labels.</code></pre>
<pre><code>## Coefficient covariances computed by hccm()</code></pre>
<pre><code>## $ANOVA
##         Effect DFn DFd          F            p p&lt;.05        ges
## 2        group   1 198 431.811012 1.207998e-51     * 0.68561998
## 3       target  10 198   1.258945 2.560987e-01       0.05978197
## 4 group:target  10 198   1.010574 4.358029e-01       0.04856061
## 
## $`Levene&#39;s Test for Homogeneity of Variance`
##   DFn DFd      SSn      SSd        F            p p&lt;.05
## 1  21 198 37.66427 72.21667 4.917428 5.462064e-10     *</code></pre>
</div>
<div id="unbalanced-designs" class="section level2 hasAnchor" number="27.6">
<h2><span class="header-section-number">27.6</span> Unbalanced designs<a href="two-way-anova.html#unbalanced-designs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <strong>balanced design</strong> means that there exactly the same
amount of observations (denoted by <span class="math inline">\(n\)</span> in the previous
examples of this lecture) in every possible combination of
factors explored by an experiment. Well, it turns out that
it is fairly common to have an <strong>unbalanced design</strong>, which
just means that there are different numbers of observations
per factor level combination. Furthermore, it turns that for
balanced designs, the sums of squares calculations I showed
are unambiguous and everybody agrees how to go about
computing them. For unbalanced designs, however, it turns
out that there are more than one way of going about
calculating sums of squares. This is often the reason why
various statistical software packages (e.g., R, SAS, SPSS,
etc) produce slightly different results. A good discussion
can be found
[here](<a href="https://www.r-bloggers.com/anova-%E2%80%93-type-iiiiii-ss-explained/" class="uri">https://www.r-bloggers.com/anova-%E2%80%93-type-iiiiii-ss-explained/</a><strong>,
but we wonâ€™t go into it here. The important thing to
remember is that in psychology and neuroscience, the
standard is to apply </strong>Type III sums of squares**, and to do
that, you just need to execute the line <code>options(contrasts = c("contr.sum","contr.poly"))</code> anywhere before you fit your
linear model and generate your ANOVA summary. Also note that
<code>options(contrasts = c("contr.sum","contr.poly"))</code> doesnâ€™t
do anything at all to balanced designs, so there is no harm
in just doing it all the time if you care for that approach.
Finally, note that whether or not a design is balanced or
not only matters for designs with at least two factors.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="one-way-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="repeated-measures-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"depth": 2
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
